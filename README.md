# Face-Detection

Face Detection with deep neural networks


## Auswahl der Datenbasis:

1. Klasse:
- Bilder die ein Gesicht enthalten
Dataset für Alter und Personen:
https://susanqq.github.io/UTKFace/


2. Klasse:
 - Bilder ohne ein Gesicht
 
 
Ziel --> Erkennung ob ein Gesicht auf dem Bild vorhanden ist oder nicht. Dabei Angabe der Wahrscheinlichkeit


Bilder:
- [x] dog_0088.jpg
- [x] e83db30d2cfc003ed1584d05fb1d4e9fe777ead218ac104497f5c978a4efb4bb_640.jpg
- [x] e83db30d2cfd033ed1584d05fb1d4e9fe777ead218ac104497f5c978a4efb4bb_640.jpg
- [x] e83db30d2cfd053ed1584d05fb1d4e9fe777ead218ac104497f5c978a4efbcb0_640.jpg
- [x] e83db30d2df5073ed1584d05fb1d4e9fe777ead218ac104497f5c978a4efbcb0_640.jpg
- [x] e83db30d2df6043ed1584d05fb1d4e9fe777ead218ac104497f5c978a4efb4bb_640.jpg
- [x] e83db30d2ef7083ed1584d05fb1d4e9fe777ead218ac104497f5c978a4efb4bb_640.jpg
- [x] flower_0472.jpg
- [x] flower_0739.jpg
- [x] motorbike_0176.jpg
- [x] motorbike_0348.jpg
- [x] n2037.jpg
- [x] OIP-_CQq|FuqYBUN7Vj205cWBgHaEK.jpeg
- [x] OIP-_MnuhOnloMjGYcP2eN-vywHaJp.jpeg
- [x] OIP-_fFULVvrJ1pzZ5opnNfLMAHaFo.jpeg 
- [x] OIP-_rrv_V15DKZfeeuOYZ_VAHaHq.jpeg
- [x] OIP-_H-D2_pPnWCCVegM9LYhKQHaFj.jpeg
- [x] OIP-_wnleOh6KMc2kur5ek1BuAHaFh.jpeg
- [x] OIP-_igk-YZOu6K8Rb2MYLLouQHaFj.jpeg
- [x] OIP-0p991juHMjs2JudwJR6iqwHaFj.jpeg
- [x] OIP-_iuGTvzHiVMaxI_jVCgbzgHaKH.jpeg
- [x] OIP-1FOgiD7WAsg3QjHo2VeZQAHaC8.jpeg
- [x] OIP-_K54-wf92Z07DTOdrqGnBQHaFj.jpeg
- [x] OIP-_kNU8jfJrt24QCgRcapmQwHaH4.jpeg
- [x] OIP-_7-NZ2rwc8GBraLOcYxSoQHaFj.jpeg
- [x] cat_0186.jpg 
- [x] cat_0723...
- [x] cat_0876....
- [x] dog_0136.jpg
- [x] 00000295_(4).jpg
- [x] 00000024_(6).jpg


Bilder sind häufiger vorhanden und müssen noch bearbeitet werden:
- [ ] n1047.jpg
- [ ] n1056.jpg
- [ ] n1060.jpg
- [ ] n1061.jpg
- [ ] n1063.jpg
- [ ] n1064.jpg
- [ ] n1065.jpg
- [ ] n1066.jpg
- [ ] n1067.jpg
- [ ] n1068.jpg
- [ ] n1110.jpg

## structure of the project:

### python files:
- [helper.py](helper.py):
  - file with functions for:
    - loading and saving models
    - import train and test images
    - compile and train models
    - generate train histories
    - predict images
- [trainingScratch.py](trainingScratch.py):
  - file for train different models with different hyperparameters from scratch
  - the trained models are automatically saved to the directory [saved_model](saved_model)
  - history of the training process is saved to the directory [plots](plots)
- [trainingTransfer.py](trainingTransfer.py):
  - file for automatically train different models and hyperparameters with transfer learning
  - the trained models are automatically saved to the directory [saved_model](saved_model)
  - history of the training process is saved to the directory [plots](plots)
- [initialTestData.py](initialTestData.py):
  - splits the raw data from the folder [rawdata](images/rawdata) into a training- and testset
  - 15 % of the pictures are randomly saved in the [test](images/test) and 85 % in the [train](images/train)
  - to do this the project must contain the following file structure of pictures:
    - images:
      - rawdata (folder with the raw dataset)
        - face
        - no_face
      - test:
        - face
        - no_face
      - train:
        - face
        - no_face
- [predictimage.py](predictimage.py):
  - opens a file dialog where you can choose a image to do a prediction with
  - To change the model for prediction change the variable "PATH_TO_MODEL" to the corresponding model saved in [saved_model](saved_model)
  - after choosing a image the image will be displayed and the prediction is shown under the picture
- [generatePlotsTensorboard.py](generatePlotsTensorboard.py):
  - generate plots for the presentation from csv-training data, which can be exported from the tensorboard dashboard
  - to generate a plot change the file paths for the pd.read_csv
- [evaluation.py](evaluation.py):
  - evaluates specific models on the test datset which is specified in the [images/test](images/test) directory
  - to change evaluated models change "model_path.__contains__()"
  - the results are stored in a csv file with the current timestamp in the [evaluation](evaluation) directory
- [convertToCoreML](convertToCoreML.py):
  - file converts a specific model to a core ML file for prediction on a iphone
  - with PATH_TO_MODEL the desired model can be choosen
- [training.py](training.py):
  - old file with quick commands for use in the python console
- [GUI.py](GUI.py):
  - file for future implementation of a gui, where you can choose different models and do predictions

### directories:
- [evaluation](evaluation)
  - contains csv files with evaluated models on the test dataset
- [images](images)
  - contains the train and test images
- [logs](logs)
  - automatically generated by tensorboard
- [plots](plots)
  - contains plots of the different training runs, which are automatically generate during training
- [presentation](presentation)
  - contains plots and csv files that are shown in the presentation
- [saved_model](saved_model)
  - contains all trained models, that can be loaded


# Second Milestone:




# Third Milestone:


# Fourth Milestone:
